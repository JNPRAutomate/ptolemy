<html   ng-app="myApp" ng-controller="AppCtrl">
<head>
    <title>Ptolemy - The Network Cartographer</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-animate.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-aria.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.js"></script>
  <script src="js/xeditable.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/0.9.4/angular-material.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700,400italic">


  <!--  Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="img/icons/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="img/icons/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/icons/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="img/icons/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/icons/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="img/icons/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="img/icons/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/icons/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/icons/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="img/icons/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/icons/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="img/icons/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/icons/favicon/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <!-- Favicon ends -->

</head>
<body>
<div ng-controller="AppCtrl" layout="column">
  <section layout="row" flex>
    <md-sidenav class="md-sidenav-left md-whiteframe-z2" md-component-id="left" md-is-locked-open="true">
      <md-content layout-padding>
        <!-- <p hide-md show-gt-md>
          This sidenav is locked open on your device. To go back to the default behavior,
          narrow your display.
        </p> -->
        <img ng-src="img/icons/logo.png" alt="Ptolemy - The Network Cartographer" style="padding-left:40px" layout-align="center center">
      </md-content>
    </md-sidenav>
    <md-content flex layout-padding>

    	<md-toolbar class="md-theme-indigo">
        	<h1 class="md-toolbar-tools">Home</h1>
      	</md-toolbar>

      <!-- Page 1 : Choose between Existing Template or download a Sample Template button -->

      <div layout="column" layout-fill layout-align="top center" ng-show="pageOneVisible">
        <md-card>
              <md-card-content>
                <h2 class="md-title">Configuration</h2>
                <md-switch class="md-primary" md-no-ink ng-model="templateSwitch" ng-change="onTemplateSwitchChange(templateSwitch)">
                Develop using Existing Template</md-switch>
                <label for="file-input" style="margin-left:20px">Browse Template</label>  
                <input id="file-input" style="margin-left:10px" type="file" ng-disabled="isTemplateDisabled">

                <md-button class="md-raised md-primary">Download Sample Template</md-button>
                </md-card-content>
          </md-card>
          <section layout="row" layout-sm="column" layout-align="center center">
              <md-button class="md-raised md-primary" ng-click="PageTwo()" ng-show="isTemplateDisabled == true"> Skip </md-button>
              <md-button class="md-raised md-primary" ng-click="PageTwo()" ng-show="isTemplateDisabled == false"> Execute </md-button>
          </section> 

      </div>

      <!-- End of Page 1 -->

      <!-- Page 2 - Configuration : Choose Global Credentials -->
      <div layout="column" layout-fill layout-align="top center"  ng-show="pageTwoVisible">
       <md-card>
              <md-card-content>
                <h2 class="md-title">Configuration</h2>
                <md-checkbox md-no-ink class="md-primary" ng-model="global_credentials" aria-label="Use Global User Credentials">
                  Use Global User Credentials
                </md-checkbox>


                <div ng-show="global_credentials == true">
                <md-radio-group ng-model="global_credential_group">
                  <md-radio-button value="User Credentials" class="md-primary" style="display:inline">User Credentials</md-radio-button>
                  <md-radio-button value="SSH Private Key Path" class="md-primary" style="display:inline"> SSH Private Key Path </md-radio-button>
                </md-radio-group>

                <!-- Username and Password If User Credentials is chosen -->
                <md-content layout-padding layout="row" layout-sm="column" ng-show="global_credential_group == 'User Credentials'">
                <!-- ng-show="userCredentials" -->
                    <label style="margin-top:10px">Username</label>
                    <input id="username" style="height:30px;margin-top:5px;margin-left:5px" ng-model="user.username">
                    <label style="margin-top:10px;margin-left:10px">Password</label>
                    <input id="password" style="height:30px;margin-top:5px;margin-left:5px" ng-model="user.password" type="{{passwordField}}">
                    <md-checkbox md-no-ink class="md-primary" ng-model="passwordField" aria-label="Show Password" id="show_password" ng-true-value="'text'" ng-false-value="'password'"> Show Password</md-checkbox>
                </md-content>


                <!-- SSH File Path Key -->
                <md-content layout-padding layout="row" layout-sm="column" ng-show="global_credential_group == 'SSH Private Key Path'"> 
                <!-- ng-show="sshCredentials" -->
                    <label style="margin-top:10px">Username</label>
                    <input id="username" style="height:30px;margin-top:5px;margin-left:5px" ng-model="user.username">
                    <label style="margin-top:10px;margin-left:10px">SSH Private Key Path</label>
                    <input type="file" id="ssh" style="margin-top:10px;margin-left:20px">
                </md-content>

                </div>


                 <!-- Settings for Log Generation -->
                <md-content layout-padding layout="row" layout-sm="column" > 

                    <div layout="row">
                      <div flex="50" flex-md="100" layout="column">
                        <fieldset class="standard" flex>
                          <legend>Output Formats</legend>
                          <div layout="row" layout-wrap>
                           <div class="standard" flex="50">
                           <md-checkbox md-no-ink class="md-primary" ng-model="format.dot" aria-label="DOT" flex="50" ng-value="DOT">
                            DOT
                           </md-checkbox>
                           </div>
                            <div class="standard" flex="50">
                           <md-checkbox md-no-ink class="md-primary" ng-model="format.json" aria-label="JSON" flex="50" ng-value="JSON">
                              JSON
                           </md-checkbox>
                           </div>
                            <div class="standard" flex="50">
                           <md-checkbox md-no-ink class="md-primary" ng-model="format.svg" aria-label="SVG" flex="50" ng-value="SVG">
                              SVG
                           </md-checkbox>
                           </div>
                            <div class="standard" flex="50">
                           <md-checkbox md-no-ink class="md-primary" ng-model="format.pdf" aria-label="PDF" flex="50" ng-value="PDF">
                              PDF
                           </md-checkbox>
                           </div>
                            <div class="standard" flex="50">
                           <md-checkbox md-no-ink class="md-primary" ng-model="format.png" aria-label="PNG" flex="50" ng-value="PNG">
                              PNG
                           </md-checkbox>
                           </div>
                          </div>
                        </fieldset>
                      </div>

                      <div flex="50" flex-md="100" layout="column">
                        <fieldset class="standard" flex>
                          <legend>Logs</legend>
                          <div layout="row" layout-wrap>
                           <md-checkbox md-no-ink class="md-primary" ng-model="logs.device" aria-label="Generate Logs Per Device">
                            Generate Logs Per Device
                           </md-checkbox>
                           <md-checkbox md-no-ink class="md-primary" ng-model="logs.global" aria-label="Generate Global Logs" >
                            Generate Global Logs
                           </md-checkbox>
                          </div>
                        </fieldset>
                      </div>
                    </div>

                </md-content>
      
              </md-card-content>
        </md-card>

        <section layout="row" layout-sm="column" layout-align="center center">
            <md-button class="md-raised md-primary" ng-click="PageOne()" > Back </md-button>
            <md-button class="md-raised md-primary" ng-click="PageThree()" > Next </md-button>
           <div class="label" style="visibility: hidden">Raised</div>
        </section> 
      </div>
      <!-- End of Page 2 -->

      <!-- Page 3 - Configuration : Upload CSV and Connection Table -->
      <div layout="column" layout-fill layout-align="top center" ng-show="pageThreeVisible">
       <md-card>
              <md-card-content>
                <h2 class="md-title">Configuration</h2>

                    <!-- Browse CSV File -->
                    <md-content layout-padding layout="row" layout-sm="column" > 
                    <!-- ng-show="sshCredentials" -->
                        <label style="margin-bottom:20px">Connection Details</label>
                        <input type="file" id="connection_details" style="margin-bottom:20px;margin-left:10px">
                    </md-content>


              		  <form editable-form name="tableform" onaftersave="saveTable()" oncancel="cancel()">


            			    <!-- table -->
            			    <table class="table table-bordered table-hover table-condensed">
            			      <tr style="font-weight: bold" align="center">
            			        <td style="width:19%">Hostname</td>
            			        <td style="width:18%">Username</td>
            			        <td style="width:18%">Password</td>
                          <td style="width:30%">SSH Private Key Path</td>
                          <td style="width:3%">Port</td>
            			        <td style="width:12%"><span ng-show="tableform.$visible">Action</span></td>
            			      </tr>
            			      <tr ng-repeat="device in connectionDetails" align="center">
            			        <td>
            			          <!-- editable username (text with validation) -->
            			          <span editable-text="device.hostname" e-form="tableform" ng-show="editableTable == false">
            			            {{ device.hostname }}
            			          </span>
            			        </td>
            			        <td>
            			          <!-- editable status (select-local) -->
            			          <span editable-text="device.username" e-form="tableform" ng-show="editableTable == false">
            			            {{ device.username }}
            			          </span>
            			        </td>
            			        <td>
            			          <!-- editable group (select-remote) -->
            			          <span editable-password="device.password" e-form="tableform" ng-show="editableTable == false">
            			            <input type="password" name="lname" disabled value="{{ device.password }}">
            			          </span>
            			        </td>
                          <td>
                            <!-- editable group (select-remote) -->
                            <span editable-text="device.path" e-form="tableform" ng-show="editableTable == false">
                              {{ device.path }}
                            </span>
                          </td>
                          <td>
                            <!-- editable group (select-remote) -->
                            <span editable-text="device.port" e-form="tableform" ng-show="editableTable == false">
                              {{ device.port }}
                            </span>
                          </td>
            			        <td><md-button class="md-raised md-warn" ng-show="tableform.$visible" ng-click="deleteUser(user.id)">Delete</md-button></td>
            			      </tr>
            			    </table>

            			    <!-- buttons -->
            			    <div class="btn-edit">
            			      <md-button  type="button" class="md-raised md-primary" ng-show="!tableform.$visible" ng-click="tableform.$show()">
            			        edit
            			      </md-button >
            			    </div>
            			    <div class="btn-form" ng-show="tableform.$visible">
            			      <md-button  type="button" ng-disabled="tableform.$waiting" ng-click="addUser()" class="md-raised md-primary">add row</md-button >
            			      <md-button  type="submit" ng-disabled="tableform.$waiting" ng-click="tableform.$save()" class="md-raised md-primary">save</md-button >
            			      <md-button  type="button" ng-disabled="tableform.$waiting" ng-click="tableform.$cancel()" class="md-raised md-primary">cancel</md-button >
            			    </div> 
        			    
        			  </form>

                </md-card-content>
          </md-card>

          <section layout="row" layout-sm="column" layout-align="center center">
              <md-button class="md-raised md-primary" ng-click="PageTwo()" > Back </md-button>
              <md-button class="md-raised md-primary" ng-click="PageOne()" > Next </md-button>
             <div class="label" style="visibility: hidden">Raised</div>
          </section> 

      </div>
      <!-- End of Page 3 -->



     <div flex></div>

    </md-content>


    <!-- Right Side Navigator -->
    <md-sidenav class="md-sidenav-right md-whiteframe-z2" md-component-id="right">
      <md-toolbar class="md-theme-light">
        <h1 class="md-toolbar-tools">Sidenav Right</h1>
      </md-toolbar>
      <md-content layout-padding>
        <form>
          <md-input-container>
            <label for="testInput">Test input</label>
            <input type="text" id="testInput"
                   ng-model="data" md-sidenav-focus>
          </md-input-container>
        </form>
        <md-button ng-click="close()" class="md-primary">
          Close Sidenav Right
        </md-button>
      </md-content>
    </md-sidenav>
    <!-- End of Right side navigator -->

  </section>
</div>


<script>
var app = angular.module('myApp', ['ngMaterial','xeditable']);
app.controller('AppCtrl', function ($scope, $timeout, $mdSidenav, $mdUtil, $log, $filter, $http, $q) {

  $scope.isTemplateDisabled = true;
  $scope.global_credentials = true;
  $scope.global_credential_group = "User Credentials";
  $scope.passwordField = "password";

	$scope.pageOneVisible = true;
	$scope.pageTwoVisible = false;
	$scope.pageThreeVisible = false;

	$scope.PageOne = function () {
		$scope.pageOneVisible = true;
		$scope.pageTwoVisible = false;
		$scope.pageThreeVisible = false;
    }

	$scope.PageTwo = function () {
		$scope.pageOneVisible = false;
		$scope.pageTwoVisible = true;
		$scope.pageThreeVisible = false;

		$http.post("/asd.svg", {file1:$scope.tracediffFile1, file2:$scope.tracediffFile2})
      .success(function (response) {
        $scope.svgFile = response;

        angular.element( document.querySelector( '#svgg' ) ).append($scope.svgFile);
		$scope.$apply ();
      });
    }

	$scope.PageThree = function () {
		$scope.pageOneVisible = false;
		$scope.pageTwoVisible = false;
		$scope.pageThreeVisible = true;
    }


  $scope.onTemplateSwitchChange = function(switchValue) {
    $scope.isTemplateDisabled = !switchValue
  }

  $scope.editableTable = false;

  $scope.configuration = [];


  $scope.connectionDetails = [
  {hostname: 'cdbu-sol-vcf-5100-24q-01.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},  
  {hostname: 'cdbu-sol-vcf-5100-24q-02.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},  
  {hostname: 'cdbu-sol-vcf-5100-24q-03.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},   
  {hostname: 'cdbu-sol-vcf-5100-24q-04.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},  
  {hostname: 'cdbu-sol-vcf-5100-48s-01.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},  
  {hostname: 'cdbu-sol-vcf-5100-48s-02.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},    
  {hostname: 'cdbu-sol-vcf-5100-48s-03.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},  
  {hostname: 'cdbu-sol-vcf-5100-48s-04.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},   
  {hostname: 'cdbu-sol-vcf-5100-48s-05.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''},   
  {hostname: 'cdbu-sol-vcf-5100-48s-06.dcbg.juniper.net', username: 'root', password: 'Embe1mpls', path: '', port: ''}
  ];


  $scope.users = [
    {id: 1, name: 'awesome user1', status: 2, group: 4, groupName: 'admin'},
    {id: 2, name: 'awesome user2', status: undefined, group: 3, groupName: 'vip'},
    {id: 3, name: 'awesome user3', status: 2, group: null}
  ]; 

  $scope.statuses = [
    {value: 1, text: 'status1'},
    {value: 2, text: 'status2'},
    {value: 3, text: 'status3'},
    {value: 4, text: 'status4'}
  ]; 

  $scope.groups = [];
  $scope.loadGroups = function() {
    return $scope.groups.length ? null : $http.get('/groups').success(function(data) {
      $scope.groups = data;
    });
  };

  $scope.showGroup = function(user) {
    if(user.group && $scope.groups.length) {
      var selected = $filter('filter')($scope.groups, {id: user.group});
      return selected.length ? selected[0].text : 'Not set';
    } else {
      return user.groupName || 'Not set';
    }
  };

  $scope.showStatus = function(user) {
    var selected = [];
    if(user.status) {
      selected = $filter('filter')($scope.statuses, {value: user.status});
    }
    return selected.length ? selected[0].text : 'Not set';
  };

  $scope.checkName = function(data, id) {
    if (id === 2 && data !== 'awesome') {
      return "Username 2 should be `awesome`";
    }
  };

  // filter users to show
  $scope.filterUser = function(user) {
    return user.isDeleted !== true;
  };

  // mark user as deleted
  $scope.deleteUser = function(id) {
    var filtered = $filter('filter')($scope.users, {id: id});
    if (filtered.length) {
      filtered[0].isDeleted = true;
    }
  };

  // add user
  $scope.addUser = function() {
    $scope.users.push({
      id: $scope.users.length+1,
      name: '',
      status: null,
      group: null,
      isNew: true
    });
  };

  // cancel all changes
  $scope.cancel = function() {
    for (var i = $scope.users.length; i--;) {
      var user = $scope.users[i];    
      // undelete
      if (user.isDeleted) {
        delete user.isDeleted;
      }
      // remove new 
      if (user.isNew) {
        $scope.users.splice(i, 1);
      }      
    };
  };

  // save edits
  $scope.saveTable = function() {
    var results = [];
    for (var i = $scope.users.length; i--;) {
      var user = $scope.users[i];
      // actually delete user
      if (user.isDeleted) {
        $scope.users.splice(i, 1);
      }
      // mark as not new 
      if (user.isNew) {
        user.isNew = false;
      }

      // send on server
      results.push($http.post('/saveUser', user));      
    }

    return $q.all(results);
  };
});

</script>
</body>
</html>